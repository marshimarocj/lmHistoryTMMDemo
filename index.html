<html>
<head>
	<meta http-equiv="Content-type" content="text/html; charset=utf-8">
	<!-- bootstrap -->
	<link rel="stylesheet" href="css/bootstrap-3.3.6/bootstrap.min.css">
	<link rel="stylesheet" href="css/bootstrap-3.3.6/bootstrap-theme.min.css">

	<link rel="stylesheet" href="css/timeglider-1.0.3/jquery-ui-1.10.3.custom.css" type="text/css" media="screen" title="no title" charset="utf-8">
	<link rel="stylesheet" href="css/timeglider-1.0.3/Timeglider.css" type="text/css" media="screen" title="no title" charset="utf-8">
	<link rel="stylesheet" href="css/timeglider-1.0.3/timeglider.datepicker.css" type="text/css" media="screen" charset="utf-8">

	<link rel="stylesheet" href="css/index.css">
</head>
<body>
	<!-- this is the banner of our demo-->
	<!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
		<div class="container">
			<div class="navbar-header">
				<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
					<span class="sr-only">Toggle navigation</span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
				</button>
				<a class="navbar-brand" href="#">
					<span class="glyphicon glyphicon-camera" aria-hidden="true"></span>
					Image Profiling for History Events
				</a>
			</div>
			<div id="navbar" class="navbar-collapse collapse">
				<!-- ul class="nav navbar-nav">
					<li class="active"><a href="#">Home</a></li>
					<li><a href="#about">About</a></li>
					<li><a href="#contact">Contact</a></li>
				</ul -->
				<ul class="nav navbar-nav navbar-right">
					<li><a href="#about">About</a></li>
				</ul>
			</div>
		</div>
	</nav>
	<!-- h1 id="pageHeader">Image Profiling for History Events</h1 -->
	<!-- use a tab widget -->
	<!-- Nav tab -->

	<div class="container theme-showcase" role="main">
		<ul class="nav nav-tabs" id="tabView">
			<li role="presentation" class="active">
				<a href="#imgs" aria-controls="imgs" role="tab" data-toggle="tab" id="imgs-tab">image</a>
			</li>
			<li role="presentation">
				<a href="#events" aria-controls="events" role="tab" data-toggle="tab" id="events-tab">event</a>
			</li>
			<li role="presentation">
				<a href="#knowledge" aria-controls="knowledge" role="tab" data-toggle="tab" id="knowledge-tab">knowledge</a>
			</li>
		</ul>

		<!-- Tab panes -->
		<div class="tab-content">

			<!-- imgs -->
			<div role="tabpanel" class="tab-pane fade in active" id="imgs">
				<div class="container">
					<!-- this section shows a list of selected images, -->
					<div class="page-header">
						<h2>What happened here in the past? <!-- small>Subtext</small --></h2>
					</div>
					<!-- use a carousel widget -->
					<div id="imgCarousel" class="carousel slide" data-ride="carousel">
						<!-- Indicators -->
						<ol class="carousel-indicators"></ol>
					</div>
				</div>
			</div>

			<!-- events -->
			<div role="tabpanel" class="tab-pane fade" id="events">
				<div class="container">
					<!-- this section shows a list of preprared events -->
					<div class="page-header">
						<h2>What do the events look like? <!-- small>Subtext</small --></h2>
					</div>
					<!-- list widget -->
					<div id="eventList" class="list-group"></div>
				</div>
			</div>

			<!-- knowledge -->
			<div role="tabpanel" class="tab-pane fade" id="knowledge" >
				<div class="container" >
					<!-- this section shows all the events from different views on the time line-->
					<div class="page-header">
						<h2>Explore our history event knowledge base automatically extracted from images!</h2>
					</div>
					<div class="row" id="timeview">
					<!-- this is a group of controls to select which subset of events to view on the time line -->
						<div class="list-group col-lg-4 col-md-4 col-xs-4">
							<a class="list-group-item" id="warList">Browse by Period</a>
							<a class="list-group-item" id="sceneList">Browse by Scene</a>
							<a class="list-group-item" id="objectList">Browse by Object</a>
						</div>
						<div class="col-lg-6 col-md-6 col-xs-6" id="pageTable"></div>
						<!-- this is a timeglider widget for viewing events on time line -->

					</div>
				</div>
			</div>
			<input type="button" id="change" value="change"/>
			<div id="timeglider" style="height:550px; "></div>

		</div>
	</div>

	<!-- common -->
	<script src="js/timeglider-1.0.3/jquery-1.9.1.min.js"></script>
	<script src="js/jquery-ui.min.js"></script>
	<script src="js/timestamp.js"></script>

	<script src="js/underscore-min.js"></script>
	<script src="js/parseUri.js"></script>
	<script src="js/widget.js"></script>
	<script src="js/bootstrap-3.3.6/bootstrap.min.js"></script>
	<script src="js/page.js"></script>
	<!-- timeglider -->

    <script src="js/timeglider-1.0.3/backbone-min.js" type="text/javascript" charset="utf-8"></script>
    <script src="js/timeglider-1.0.3/ba-debug.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="js/timeglider-1.0.3/jquery.tmpl.js" type="text/javascript" charset="utf-8"></script>
	<script src="js/timeglider-1.0.3/ba-debug.min.js" type="text/javascript" charset="utf-8"></script>
	<script src="js/timeglider-1.0.3/ba-tinyPubSub.js" type="text/javascript" charset="utf-8"></script>
	<script src="js/timeglider-1.0.3/jquery.mousewheel.js" type="text/javascript" charset="utf-8"></script>
	<script src="js/timeglider-1.0.3/jquery.ui.ipad.js" type="text/javascript" charset="utf-8"></script>
	<script src="js/timeglider-1.0.3/globalize.js" type="text/javascript" charset="utf-8"></script>

    <script src="js/timeglider-1.0.3/jquery-ui-1.10.3.custom.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="js/timeglider-1.0.3/TG_Date.js" type="text/javascript" charset="utf-8"></script>
	<script src="js/timeglider-1.0.3/TG_Org.js" type="text/javascript" charset="utf-8"></script>
	<script src="js/timeglider-1.0.3/TG_Timeline.js" type="text/javascript" charset="utf-8"></script>
	<script src="js/timeglider-1.0.3/TG_TimelineView.js" type="text/javascript" charset="utf-8"></script>
	<script src="js/timeglider-1.0.3/TG_Mediator.js" type="text/javascript" charset="utf-8"></script>
	<script src="js/timeglider-1.0.3/timeglider.timeline.widget.js" type="text/javascript"></script>
    <script src="js/timeglider-1.0.3/timeglider.datepicker.js" type="text/javascript"></script>

    <script src="js/timeglider-1.0.3/jquery.jscrollpane.min.js" type="text/javascript"></script>



	<script>
var imgJsonUrl = 'queryImg.json';
var eventJsonUrl = 'events.sample.json';
var browseJsonUrls = ['browseByWar.json', 'browseByScene.json', 'browseByObject.json'];
var timeJsonUrl = 'testdata/history.json';
var timeRootJsonUrl = '';

var imgData = undefined;
var eventData = undefined;
var browseData = [undefined, undefined, undefined];

function pagedTableProcessFunc(item)
{
	// return the created element
}

function pagedTableClickFunc(item)
{
	var wordId = item[0];
	var jsonUrl = timeRootJsonUrl + wordId + '.json';
	var timeGlider = new TimeGlider($('#timeglider'));
	timeGlider.GetData(jsonUrl);
}


$(document).ready(function() {
	// image tab
	// d is a list of [imgId, imgUrl]
	$.getJSON(imgJsonUrl, function(d) {
		imgData = d;
		var imgCarousel = new Carousel($('#imgCarousel'), d, function(item) {
			// create and return img element
		});
	/*	imgCarousel.SetItemClickFunc(function(item) {// link to match.html
			var iid = item[0];
			var url = 'match.html?iid' + iid;
			window.location = url;
		});
	*/
	});

	// event tab
	$('#events-tab').click(function() {
		if(eventData != undefined) return;

		$.getJSON(eventJsonUrl, function(d) {
			eventData = d;

			// d is a list of [eid, text]
			var eventList = new ListView($('#eventList'), d, function(item) {
				//create and return div element which constains the text
			});
		/*	eventList.SetItemClickFunc(function(item) {// link to event.html
				var eid = item[0];
				var url = 'event.html?eid' + eid;
				window.location = url;
			});
		*/
		});
	});

	// knowledge tab
	_.each(['#warList', '#sceneList', '#objectList'], function(d, i) {
		$(d).click(function() {
			var param = {rows: 4, cols: 5};
			if(browseData[i] != undefined){// refresh paged table with stored data
				var pagedTable = new PagedTable($('#pageTable'), browseData[i], param, pagedTableProcessFunc);
				// pagedTable.SetItemClickFunc(pagedTableClickFunc);
			}
			else
			{
				// d is a list of [wordId, word]
				$.getJSON(browseJsonUrls[i], function (d) {// get data to refresh paged table
					browseData[i] = d;
					var pagedTable = new PagedTable($('#pageTable'), d, param, pagedTableProcessFunc);
					// pagedTable.SetItemClickFunc(pagedTableClickFunc);
				});
			}
		});
	});

	// initialize timeGlider in knowledge tab
	var timeGlider = new TimeGlider($('#timeglider'));
	timeGlider.GetData(timeJsonUrl);

	$("#change").click(function(){
        timeGlider.GetData('testdata/history2.json');
    })
});
	</script>
</body>
