<html>
<head>
	<meta http-equiv="Content-type" content="text/html; charset=utf-8">
	<!-- bootstrap -->
	<link rel="stylesheet" href="css/bootstrap-3.3.6/bootstrap.min.css">
	<link rel="stylesheet" href="css/bootstrap-3.3.6/bootstrap-theme.min.css">

	<link rel="stylesheet" href="css/index.css">
</head>
<body>
	<!-- this is the banner of our demo-->
	<!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
		<div class="container">
			<div class="navbar-header">
				<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
					<span class="sr-only">Toggle navigation</span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
				</button>
				<a class="navbar-brand" href="#">
					<span class="glyphicon glyphicon-camera" aria-hidden="true"></span>
					Image Profiling for History Events
				</a>
			</div>
			<div id="navbar" class="navbar-collapse collapse">
				<!-- ul class="nav navbar-nav">
					<li class="active"><a href="#">Home</a></li>
					<li><a href="#about">About</a></li>
					<li><a href="#contact">Contact</a></li>
				</ul -->
				<ul class="nav navbar-nav navbar-right">
					<li><a href="#about">About</a></li>
				</ul>
			</div>
		</div>
	</nav>
	<!-- h1 id="pageHeader">Image Profiling for History Events</h1 -->
	<!-- use a tab widget -->
	<!-- Nav tab -->

	<div class="container theme-showcase" role="main">
		<ul class="nav nav-tabs" id="tabView">
			<li role="presentation" class="active">
				<a href="#imgs" aria-controls="imgs" role="tab" data-toggle="tab" id="imgs-tab">image</a>
			</li>
			<li role="presentation">
				<a href="#events" aria-controls="events" role="tab" data-toggle="tab" id="events-tab">event</a>
			</li>
			<li role="presentation">
				<a href="#knowledge" aria-controls="knowledge" role="tab" data-toggle="tab" id="knowledge-tab">knowledge</a>
			</li>
		</ul>

		<!-- Tab panes -->
		<div class="tab-content">

			<!-- imgs -->
			<div role="tabpanel" class="tab-pane fade in active" id="imgs">
				<div class="container">
					<!-- this section shows a list of selected images, -->
					<div class="page-header">
						<h2>What happened here in the past? <!-- small>Subtext</small --></h2>
					</div>
					<!-- use a carousel widget -->
					<div id="imgCarousel" class="carousel slide" data-ride="carousel">
						<!-- Indicators -->
						<ol class="carousel-indicators"></ol>
					</div>
				</div>
			</div>

			<!-- events -->
			<div role="tabpanel" class="tab-pane fade" id="events">
				<!-- this section shows a list of preprared events -->
				<h2>What do the events look like?</h2>
				<!-- list widget -->
				<div id="eventList"></div>
			</div>

			<!-- knowledge -->
			<div role="tabpanel" class="tab-pane fade" id="knowledge">
				<!-- this section shows all the events from different views on the time line-->
				<h2>Explore our history event knowledge base automatically extracted from images!</h2>
				<div id="timeview">
					<!-- this is a group of controls to select which subset of events to view on the time line -->
					<table>
						<tr>
							<td>
								<a href='#warList' id="warList">Browse by Period</a>
								<a href='#sceneList' id="sceneList">Browse by Scene</a>
								<a href='#objectList' id="objectList">Browse by Object</a>
							</td>
							<td>
								<div id="pageTable"></div>
							</td>
						</tr>
					</table>
					<!-- this is a timeglider widget for viewing events on time line -->
					<div id="timeglider"></div>
				</div>
			</div>

		</div>
	</div>

	<!-- common -->
	<script src="js/timeglider-1.0.3/jquery-1.9.1.min.js"></script>
	<script src="js/underscore-min.js"></script>
	<script src="js/parseUri.js"></script>
	<script src="js/widget.js"></script>
	<script src="js/bootstrap-3.3.6/bootstrap.min.js"></script>
	<!-- timeglider -->

	<script>
var imgJsonUrl = 'testdata/img.json';
var eventJsonUrl = 'testdata/event.json';
var browseJsonUrls = ['', '', ''];
var timeJsonUrl = '';
var timeRootJsonUrl = '';

var imgData = undefined;
var eventData = undefined;
var browseData = [undefined, undefined, undefined];

function pagedTableProcessFunc(item)
{
	// return the created element
}

function pagedTableClickFunc(item)
{
	var wordId = item[0];
	var jsonUrl = timeRootJsonUrl + wordId + '.json';
	var timeGlider = new TimeGlider($('#timeglider'));
	timeGlider.GetData(jsonUrl);
}

$(document).ready(function() {
	// image tab
	// d is a list of [imgId, imgUrl]
	$.getJSON(imgJsonUrl, function(d) {
		imgData = d;
		var imgCarousel = new Carousel($('#imgCarousel'), d, function(item) {
			// create and return img element
		});
	/*	imgCarousel.SetItemClickFunc(function(item) {// link to match.html
			var iid = item[0];
			var url = 'match.html?iid' + iid;
			window.location = url;
		});
	*/
	});

	// event tab
	$('#events-tab').click(function() {
		if(eventData != undefined) return;

		$.getJSON(eventJsonUrl, function(d) {
			eventData = d;

			// d is a list of [eid, text]
			var eventList = new ListView($('#eventList'), d, function(item) {
				//create and return div element which constains the text
			});
		/*	eventList.SetItemClickFunc(function(item) {// link to event.html
				var eid = item[0];
				var url = 'event.html?eid' + eid;
				window.location = url;
			});
		*/
		});
	});

	// knowledge tab
	_.each(['#warList', '#sceneList', '#objectList'], function(d, i) {
		$(d).click(function() {
			if(browseData[i] != undefined){// refresh paged table with stored data
				var pagedTable = new PagedTable($('#pageTable'), d, param, pagedTableProcessFunc);
				pagedTable.SetItemClickFunc(pagedTableClickFunc);
			}
			else
			{
				// d is a list of [wordId, word]
				$.getJSON(browseJsonUrls[i], function (d) {// get data to refresh paged table
					browseData[i] = d;
					var param = {rows: 4, cols: 5};
					var pagedTable = new PagedTable($('#pageTable'), d, param, pagedTableProcessFunc);
					pagedTable.SetItemClickFunc(pagedTableClickFunc);
				});
			}
		});
	});

	// initialize timeGlider in knowledge tab
	var timeGlider = new TimeGlider($('#timeglider'));
	timeGlider.GetData(timeJsonUrl);
});
	</script>
</body>
